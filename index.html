<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Connexion WhatsApp via QR Code</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 20px; text-align: center; }
    #qr { margin-top: 20px; }
    img { max-width: 300px; border: 1px solid #ccc; padding: 10px; background: white; border-radius: 8px; }
    button { padding: 10px 20px; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Connexion à WhatsApp</h2>
  <p>Scanne ce QR Code avec WhatsApp (Appareils connectés)</p>
  <div id="qr">Chargement du QR code...</div>
  <button onclick="loadQr()">Rafraîchir le QR Code</button>

  <script>
    async function loadQr() {
      const qrDiv = document.getElementById("qr");
      qrDiv.textContent = "Chargement...";

      try {
        const response = await fetch("https://free-whatsapp-sender.p.rapidapi.com/qrcode", {
          method: "GET",
          headers: {
            "x-rapidapi-host": "free-whatsapp-sender.p.rapidapi.com",
            "x-rapidapi-key": "ab42dda446mshde4ba65d25b85fdp13b83ejsn3965c0519b7d"
          }
        });

        const data = await response.json();

        if (data.qrcode) {
          qrDiv.innerHTML = `<img src="${data.qrcode}" alt="QR Code WhatsApp">`;
        } else {
          qrDiv.innerHTML = "QR code non disponible.";
        }

      } catch (error) {
        console.error(error);
        qrDiv.innerHTML = "Erreur lors du chargement du QR code.";
      }
    }

    // Charger automatiquement au démarrage
    loadQr();
  </script>
</body>
</html>